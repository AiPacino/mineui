light.has("/alipay/security/riskMobileAccount")||function(b,j){try{window==window.parent&&b.client.storage.set("riskMobileAccoutSendTime",-1)}catch(k){}var h={Name:"riskMobileAccount",defaults:{id:"",autoSend:!0,isBind:"",ajaxUrl:"",countdownBefore:null,countdownAfter:null,requestBefore:null,requestAfter:null}},g={sms:{className:".sms-btn",btnText:"\u91cd\u65b0\u83b7\u53d6\u77ed\u4fe1",interval:120,prompt_send:"\u6821\u9a8c\u7801\u5df2\u53d1\u9001\uff0c30\u5206\u949f\u5185\u8f93\u5165\u6709\u6548\uff0c\u8bf7\u52ff\u6cc4\u9732",
prompt_default:"\u6821\u9a8c\u7801\u662f6\u4f4d\u6570\u5b57\uff0c30\u5206\u949f\u5185\u8f93\u5165\u6709\u6548\uff0c\u8bf7\u52ff\u6cc4\u9732"},phone:{className:".phone-btn",btnText:"\u4f7f\u7528\u8bed\u97f3\u83b7\u53d6",interval:120,prompt_send:"\u652f\u4ed8\u5b9d\u5c06\u5411\u60a8\u7684\u624b\u673a\u62e8\u6253\u7535\u8bdd\u5e76\u64ad\u62a5\u6821\u9a8c\u7801\u3002<br />\u6765\u7535\u53f7\u7801\u4e3a\uff1a0571-26883721,\u8bf7\u7a0d\u5019...",prompt_default:"\u6821\u9a8c\u7801\u662f6\u4f4d\u6570\u5b57\uff0c30\u5206\u949f\u5185\u8f93\u5165\u6709\u6548\uff0c\u8bf7\u52ff\u6cc4\u9732"}};
h.properties={targets:[]};h=b.register("/alipay/security/riskMobileAccount",window,b.deriveFrom(j.base,{ready:!0,render:function(a){b.isFunction(a)&&this._readyList.push(a);this.element=this.options.uniqElement;for(a=this._readyList;a.length;)a.shift().apply(this)},getValue:function(){return{mobileAckCode:this.element.value}},postInit:function(){var a=this,c=this.options;this.container=b.node(this.options.uniqElement).parent(".ui-form-item");this.itemExp=this.container.find(".ui-form-explain");b.each(g,
function(b,d){var e=a.container.find(d.className);e.length&&(e.type=b,!c.defaultType&&(c.defaultType=b),a.targets.push(e))});this.targets.length||b.log("No mode used.");c.autoSend&&this.request("sms");this.bind()},bind:function(){var a=this,c=this.options;this.options.autoSend||this.container.find(".send-btn").click(function(){b.node(this).addClass("fn-hide");a.container.find(".ui-form-field, .ui-form-explain").removeClass("fn-hide");a.request("sms")});this.container.find(".reSend-btn").click(function(f){f.cancel();
b.node(this).addClass("fn-hide");a.container.find(".sms-btn, .phone-btn").removeClass("fn-hide");a.sendSuccess(c.defaultType);a.countdown(c.defaultType)});b.each(this.targets,function(c,b){b.click(function(){a.send(b.type)})});b.ready(function(){b.node(".phone-btn").length&&(a.pop=new b.pop({targets:b.node(".phone-btn"),className:"ui-securitycore",width:400}))})},send:function(a){a=a||this.options.defaultType;this.countdown(a);this.request(a)},countdown:function(a){var c=this,b=c.options,a=a||b.defaultType,
d=g[a].interval;b.countdownBefore&&b.countdownBefore();(function(){0<d--?(c.toggleBtnUI(d),setTimeout(arguments.callee,1E3)):(c.updatePrompt(a,"prompt_default"),c.toggleBtnUI(d,!0),c.container.removeClass("ui-form-item-success"),b.countdownAfter&&b.countdownAfter())})()},toggleBtnUI:function(a,c){var f=this,d,e=c?"removeClass":"addClass";b.each(this.targets,function(b,i){d=c?g[i.type].btnText:"\uff08"+a+"\u79d2\u540e\uff09"+g[i.type].btnText;c||f.pop&&f.pop.hide();i[e]("ui-checkcode-messagecode-disabled-btn").attr("disabled",
!c).attr("value",d)})},updatePrompt:function(a,b){this.container.find(".ui-form-explain").html(g[a][b])},request:function(a){if(window!=window.parent){var c=(new Date).getTime(),f=Number(b.client.storage.get("riskMobileAccoutSendTime"));if(0>c-f){this.sendSuccess(a);return}}var d=this,e=this.options,c={},a=a||e.defaultType;e.requestBefore&&e.requestBefore();this.inputMobileNo&&(c.inputMobileNo=this.inputMobileNo);c.type=a;c.securityId=b.node(this.options.uniqElement).parent(".J-securitycoreMain").attr("data-request");
c.rnd=Math.random();c.validateProductName="risk_mobile_account";b.request(e.ajaxUrl,c,{method:"JSONP",success:function(c){if(c.info.sent){try{window!=window.parent?b.client.storage.set("riskMobileAccoutSendTime",(new Date).getTime()):b.client.storage.set("riskMobileAccoutSendTime",-1)}catch(f){}d.sendSuccess(a)}else d.showError(c.info);e.requestAfter&&d.options.requestAfter(c)}})},showError:function(a){this.itemExp.html(a.errorMessage);this.container.removeClass("ui-form-item-success").addClass("ui-form-item-error")},
sendSuccess:function(a){a=a||this.options.defaultType;this.container.removeClass("ui-form-item-error").addClass("ui-form-item-success");this.updatePrompt(a,"prompt_send")}},h))}(window.light,alipay.security);