light.has("/alipay/security/riskSudoku")||function(e){var f={Name:"riskSudoku"},f=e.riskSudoku=light.deriveFrom(e.base,{render:function(a){light.isFunction(a)&&this._readyList.push(a);this.ready||(this.element=light.node(this.options.uniqElement),this.container=light.node(light.get(this.options.container)),this.keyboard=this.container.find(".risk-sudoku-keyboard"),this.resendBtn=this.container.find(".risk-sudoku-resend-btn"),this.clearInputIcon=this.container.find(".clear-input"),this.ready=!0);for(a=
this._readyList;a.length;)a.shift().apply(this)},postInit:function(){this.onready(function(){this._bindKeyboardEvents();this._bindResendBtn();this._bindClearInput();this._sendSMS()})},getValue:function(){return this.element.val()},_bindKeyboardEvents:function(){var a=light.node("table tr td a",this.keyboard),c=this,d=c.element.parent();light.each(a,function(a,g){light.on(g,"click",function(a){a.cancel();d.removeClass("fn-hide");var a=light.node(a.target).text(),b=c.element;b.val().length>=c.options.ackNum||
b.val(b.val()+a)})})},_bindClearInput:function(){var a=this;light.on(this.clearInputIcon[0],"click",function(c){c.cancel();a.element.val("")})},_bindResendBtn:function(){var a=this;light.on(this.resendBtn[0],"click",function(){a._sendSMS()})},_sendSMS:function(){var a=this;this.resendBtn.attr("disabled","disabled");this.resendBtn.addClass("ui-checkcode-messagecode-disabled-btn");var c={securityId:a.options.securityId,validateProductName:this.options.productName};a._smsTip(!0,"\u6821\u9a8c\u7801\u5df2\u53d1\u9001\uff0c15\u5206\u949f\u5185\u8f93\u5165\u6709\u6548\u3002");
light.request(this.options.resendUrl,c,{method:"JSONP",success:function(b){if("ok"==b.stat){if(b.info)if(b.info.sent||(a._smsTip(!1,b.info.errorMessage),light.log(b.info.errorMessage),a._enableResendBtn()),b.info.sudoku){a.letters={};var c=light.node("table tr td a",a.keyboard);light.each(b.info.sudoku,function(b,d){a.letters[d.code]=d.index;light.node(c[b]).text(d.code)})}else a._smsTip(!1,b.info.errorMessage||"\u7f51\u7edc\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u4faf\u518d\u8bd5\u3002"),light.log("\u670d\u52a1\u5668\u9519\u8bef\uff0c\u672a\u8fd4\u56de\u53ef\u9009\u5b57\u7b26\u7ed3\u679c"),
a._enableResendBtn()}else light.log("error")},failure:function(){light.log("failure")}});var d=120;clearInterval(a._intervalHandler);this._intervalHandler=setInterval(function(){if(0==d)a._enableResendBtn();else{var b=d--+"\u79d2\u540e\u91cd\u53d1\u77ed\u4fe1";a.resendBtn.text(b)}},1E3)},_enableResendBtn:function(){this.resendBtn.text("\u91cd\u65b0\u83b7\u53d6\u77ed\u4fe1").attr("disabled",!1).removeClass("ui-checkcode-messagecode-disabled-btn");clearInterval(this._intervalHandler)},_smsTip:function(a,
c){this.resendBtn.next(".ui-form-explain").text(c||"");var d=this.resendBtn.parent(".resend-group");a?d.removeClass("ui-form-item-error"):d.addClass("ui-form-item-error")}},f)}(alipay.security);